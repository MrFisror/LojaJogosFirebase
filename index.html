<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Level Up Store - Tech</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">

    <style>
        body { 
            padding-top: 20px; 
            background-color: #f0f2f5; 
            font-family: 'Roboto', sans-serif;
        }

        /* --- DESIGN TECH --- */
        .tech-brand {
            font-family: 'Orbitron', sans-serif;
            font-weight: 900;
            font-size: 2rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            background: linear-gradient(45deg, #0d6efd, #6610f2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .icon-tech {
            font-size: 1.8rem;
            background: none;
            -webkit-text-fill-color: initial;
            color: #6610f2;
        }

        .card {
            border: none;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
            overflow: hidden;
        }
        
        .card-jogo:hover { 
            transform: translateY(-5px); 
            box-shadow: 0 10px 20px rgba(13, 110, 253, 0.15); 
        }

        /* --- VISIBILIDADE DOS BOTÕES NOS CARDS --- */
        /* Isso controla APENAS os botões pequenos de editar/excluir nos cards */
        .card-admin-btns {
            display: none !important;
        }

        /* Se o body tiver a classe modo-admin, os botões aparecem */
        body.modo-admin .card-admin-btns {
            display: flex !important;
        }
    </style>
</head>

<body>

    <div class="container">
        <div class="d-flex justify-content-between align-items-center mb-4 mt-2">
            <h1 class="m-0 tech-brand">
                <span class="icon-tech">⚡</span> LEVEL UP STORE
            </h1>
            
            <div class="d-flex align-items-center gap-2">
                <div id="areaAuth">
                    <button id="btnLoginUI" class="btn btn-outline-primary fw-bold" data-bs-toggle="modal" data-bs-target="#modalLogin">
                        <i class="bi bi-person-circle"></i> Login
                    </button>
                    <button id="btnLogoutUI" class="btn btn-outline-danger fw-bold d-none">
                        <i class="bi bi-box-arrow-right"></i> Sair
                    </button>
                </div>

                <button class="btn btn-primary position-relative shadow-sm fw-bold" data-bs-toggle="modal" data-bs-target="#modalCarrinho">
                    <i class="bi bi-cart-fill"></i> Carrinho
                    <span id="contagemCarrinho" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger border border-light">
                        0
                    </span>
                </button>
            </div>
        </div>

        <div id="painelAdmin" class="card p-4 mb-4 bg-white border border-primary border-opacity-25 d-none">
            <div class="d-flex align-items-center gap-2 mb-3">
                <i class="bi bi-shield-lock-fill text-primary fs-4"></i>
                <h5 class="text-primary fw-bold m-0" style="font-family: 'Orbitron', sans-serif;">ADMIN DASHBOARD</h5>
            </div>
            
            <form id="formJogo">
                <div class="row g-3">
                    <div class="col-md-4">
                        <div class="input-group">
                            <span class="input-group-text bg-light border-0"><i class="bi bi-controller"></i></span>
                            <input type="text" id="titulo" class="form-control bg-light border-0" placeholder="Título do Jogo" required>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="input-group">
                            <span class="input-group-text bg-light border-0">R$</span>
                            <input type="number" id="preco" step="0.01" class="form-control bg-light border-0" placeholder="Preço" required>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <input type="text" id="genero" class="form-control bg-light border-0" placeholder="Gênero">
                    </div>
                    <div class="col-md-2">
                        <button type="submit" class="btn btn-success w-100 fw-bold">
                            <i class="bi bi-plus-lg"></i> Salvar
                        </button>
                    </div>
                </div>
            </form>
        </div>

        <div class="row mb-4 g-3">
            <div class="col-md-7">
                <div class="input-group shadow-sm">
                    <span class="input-group-text bg-white border-0 ps-3"><i class="bi bi-search"></i></span>
                    <input type="text" id="campoBusca" class="form-control border-0 py-2" placeholder="O que você procura?">
                </div>
            </div>
            <div class="col-md-5 d-flex justify-content-end">
                <div class="btn-group shadow-sm w-100">
                    <button class="btn btn-white bg-white border-0 text-secondary" onclick="carregarJogos()">Padrão</button>
                    <button class="btn btn-white bg-white border-0 text-secondary" onclick="carregarJogos('titulo')">A-Z</button>
                    <button class="btn btn-white bg-white border-0 text-secondary" onclick="carregarJogos('preco')">$ Menor</button>
                    <button class="btn btn-white bg-white border-0 text-secondary" onclick="carregarJogos('genero')">Gênero</button>
                </div>
            </div>
        </div>

        <div id="listaJogos" class="row g-4">
            <p class="text-center text-muted mt-5">
                <i class="bi bi-hourglass-split"></i> Carregando catálogo...
            </p>
        </div>
    </div>

    <div class="modal fade" id="modalCarrinho" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content border-0 shadow">
                <div class="modal-header border-bottom-0">
                    <h5 class="modal-title fw-bold"><i class="bi bi-bag-check"></i> Seu Carrinho</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <table class="table table-hover">
                        <thead class="table-light">
                            <tr><th>Jogo</th><th>Preço</th><th>Ação</th></tr>
                        </thead>
                        <tbody id="itensCarrinho"></tbody>
                    </table>
                    <div class="text-end mt-4">
                        <h4 class="fw-bold">Total: <span id="totalCarrinho" class="text-primary">R$ 0,00</span></h4>
                    </div>
                </div>
                <div class="modal-footer border-top-0">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">Fechar</button>
                    <button type="button" class="btn btn-primary px-4 fw-bold" onclick="finalizarCompraTotal()">Finalizar Pedido</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="modalLogin" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border-0 shadow-lg">
                <div class="modal-header border-bottom-0 pb-0">
                    <h5 class="modal-title fw-bold">Acessar Conta</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-4">
                    <form id="formLogin">
                        <div class="mb-3">
                            <label class="form-label text-muted small">E-mail</label>
                            <input type="email" id="emailLogin" class="form-control bg-light border-0" placeholder="admin@loja.com" required>
                        </div>
                        <div class="mb-4">
                            <label class="form-label text-muted small">Senha</label>
                            <input type="password" id="senhaLogin" class="form-control bg-light border-0" required>
                        </div>
                        <button type="submit" class="btn btn-primary w-100 mb-3 fw-bold">Entrar</button>
                        <button type="button" class="btn btn-outline-secondary w-100" id="btnCriarConta">
                            Criar Nova Conta
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
        import { getFirestore, collection, addDoc, getDocs, doc, deleteDoc, updateDoc, query, orderBy } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-firestore.js";
        import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, signOut, onAuthStateChanged } 
        from "https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBZEW-zhqmThRWeKeYVL2QDpjfcjq6zLSU",
            authDomain: "projetofinal-lojadejogos-d607f.firebaseapp.com",
            projectId: "projetofinal-lojadejogos-d607f",
            storageBucket: "projetofinal-lojadejogos-d607f.firebasestorage.app",
            messagingSenderId: "722453792468",
            appId: "1:722453792468:web:594a993d53271587065d41"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);

        window.db = db;
        window.auth = auth;
        window.collection = collection;
        window.addDoc = addDoc;
        window.getDocs = getDocs;
        window.doc = doc;
        window.deleteDoc = deleteDoc;
        window.updateDoc = updateDoc;
        window.query = query;      
        window.orderBy = orderBy;  
        
        window.signInWithEmailAndPassword = signInWithEmailAndPassword;
        window.createUserWithEmailAndPassword = createUserWithEmailAndPassword;
        window.signOut = signOut;
        window.onAuthStateChanged = onAuthStateChanged;

        const evento = new Event('firebase-pronto');
        window.dispatchEvent(evento);
    </script>

    <script src="app.js"></script>
</body>
</html>